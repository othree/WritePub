(function(){var a={};$.extend(a,{options:{},meta:{toolbar:[{title:"read",id:"read"},{title:"zoom",id:"zoom"},{title:"download",id:"download"},{title:"about",id:"about"}]},book:{meta:{title:_("New Book"),desc:_("Book Description")}}});$.extend(a,{init:function(){a.inited=true;a.options.mode=document.location.protocol=="file:"?"w":"r";a.options.path=document.location.pathname.replace(/[^\/]*$/,"");a.loadMeta();a.ui.init();a.load("introduction")},load:function(){},loadMeta:function(){var b=a.loadFile("meta.json");
if(b!==false){b=JSON.parse(b);$.extend(a.book.meta,b)}},saveMeta:function(){var b=a.book.meta;b=JSON.stringify(b);a.saveFile("meta.json",b)},loadTOC:function(){},loadContent:function(){},setContent:function(){},saveFile:function(b,c){return a.options.mode=="w"?saveFile(b,c):false},loadFile:function(b){var c=document.location.protocol+"//"+document.location.host+a.options.path+b;if(a.options.mode=="w")return loadFile(b);else{b=$.ajax({url:c,async:false});return b.status==200?b.responseText:false}},
loadEditor:function(){},inited:false});$.extend(a,{ui:{init:function(){if(!a.inited)return false;a.ui.inited=true;var b=$("#container");if(b.length===0){$("body").append($('<div id="container"></div>'));b=$("#container")}b.html(a.ui.initTemplate);a.ui.updateHeader();a.ui.toolbar(a.meta.toolbar)},updateHeader:function(){$("#header h1").html(a.book.meta.title);$("#desc").html(a.book.meta.desc)},breadcrumbs:function(b){if(!a.ui.inited)return false;a.ui.fillList($("#breadcrumbs"),b)},toolbar:function(b){if(!a.ui.inited)return false;
a.ui.fillList($("#toolbar"),b)},fillList:function(b,c){for(var e="",d=0,f=c.length;d<f;d++)e+='<li><a href="#'+c[d].id+'">'+_(c[d].title)+"</a></li>";b.html(e)},getBody:function(){return $("body")},initTemplate:'<div id="header">    <h1></h1>    <p id="desc"></p></div><div id="nav">    <ol id="breadcrumbs">    </ol>    <ul id="toolbar">    </ul>    <div id="progress"></div></div><div id="main">    <div id="menu">        <ol id="toc">        </ol>        <p>            <a id="goto-content" href="">'+
_("goto content")+'</a>        </p>    </div>    <div id="content">        <textarea id="editor"></textarea>    </div></div>',inited:false}});$(a.init);window.writepub=a})();
